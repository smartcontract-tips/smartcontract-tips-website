---
layout: post
title: 'SWC Registry: What is it and who created it?'
date: 2023-05-05 11:25:00.000000000 +02:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- English
- In-Depth
tags: []
permalink: "/articoli/swc-registry/"
excerpt: Smart contracts are a fundamental part of blockchain technology, and they
  have enabled a wide range of innovative applications, from decentralized finance
  to supply chain management. However, like any software, smart contracts can have
  security vulnerabilities that can be exploited by attackers. In this article, we’ll
  introduce the Smart Contract Weakness Classification and Test Cases (SWC) registry,
  a tool that can help developers identify and mitigate these vulnerabilities.
featured_image: featured_images/Screenshot2023-06-07at11.53.01.png
---
<div class="<br />
          image-block-outer-wrapper<br />
          layout-caption-below<br />
          design-layout-inline<br />
          combination-animation-site-default<br />
          individual-animation-site-default<br />
          individual-text-animation-site-default<br />
        " data-test="image-block-inline-outer-wrapper"><br />
<figure class="<br />
              sqs-block-image-figure<br />
              intrinsic<br />
            " style="max-width:728px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element</p>
<p>              has-aspect-ratio<br />
            " style="<br />
                position: relative;</p>
<p>                  padding-bottom:56.31868362426758%;</p>
<p>                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);<br />
              "></p></div>
</div>
<p><img data-stretch="false" src="{{ site.baseurl }}/assets/2023/05/Screenshot+2023-06-07+at+11.52.31.png" data-image="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/9dc97c10-262d-42f5-856b-3de07a494a6d/Screenshot+2023-06-07+at+11.52.31.png" data-image-dimensions="728x410" data-image-focal-point="0.5,0.5" alt="" data-load="false" width="728" height="410" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" srcset="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/9dc97c10-262d-42f5-856b-3de07a494a6d/Screenshot+2023-06-07+at+11.52.31.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/9dc97c10-262d-42f5-856b-3de07a494a6d/Screenshot+2023-06-07+at+11.52.31.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/9dc97c10-262d-42f5-856b-3de07a494a6d/Screenshot+2023-06-07+at+11.52.31.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/9dc97c10-262d-42f5-856b-3de07a494a6d/Screenshot+2023-06-07+at+11.52.31.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/9dc97c10-262d-42f5-856b-3de07a494a6d/Screenshot+2023-06-07+at+11.52.31.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/9dc97c10-262d-42f5-856b-3de07a494a6d/Screenshot+2023-06-07+at+11.52.31.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/9dc97c10-262d-42f5-856b-3de07a494a6d/Screenshot+2023-06-07+at+11.52.31.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" /></p>
</figure>
</div>
<div class="sqs-html-content">
<h2 style="white-space:pre-wrap;"><strong>Introduction:</strong></h2>
<p class="sqsrte-large" style="white-space:pre-wrap;">Smart contracts are a fundamental part of blockchain technology, and they have enabled a wide range of innovative applications, from decentralized finance to supply chain management. However, like any software, smart contracts can have security vulnerabilities that can be exploited by attackers. In this article, we’ll introduce the Smart Contract Weakness Classification and Test Cases (SWC) registry, a tool that can help developers identify and mitigate these vulnerabilities.</p>
<h2 style="white-space:pre-wrap;"><strong>What is the SWC Registry?</strong></h2>
<p class="sqsrte-large" style="white-space:pre-wrap;">The SWC Registry, also known as the Smart Contract Weakness Classification Registry, is a project that aims to maintain a comprehensive list of known security vulnerabilities and weaknesses in smart contracts on various blockchain platforms, including Ethereum, Binance Smart Chain, and others. The project was initiated by a group of security researchers and experts who recognized the importance of identifying and mitigating security risks in smart contracts.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">The SWC Registry provides a standardized classification system for identifying and describing different types of smart contract vulnerabilities and weaknesses. It currently includes over 200 entries that cover a wide range of security issues, such as integer overflow and underflow, reentrancy attacks, and permission issues.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">Each entry in the SWC Registry includes a unique identifier, a title, a description of the vulnerability or weakness, and information about its potential impact and severity. The entries are categorized based on their level of severity, with categories ranging from “low” to “critical.”</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">Developers and auditors can use the SWC Registry as a reference when conducting security audits or when developing smart contracts. By consulting the registry, developers can ensure that their smart contracts do not contain any known vulnerabilities or weaknesses and can take the necessary steps to mitigate any identified risks.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">In addition to providing a comprehensive list of smart contract vulnerabilities, the SWC Registry also serves as a platform for discussing and addressing new security issues as they arise. The project is open-source, and anyone can contribute by submitting new vulnerabilities or weaknesses, suggesting changes to existing entries, or participating in discussions about emerging security threats.</p>
<h2 style="white-space:pre-wrap;"><strong>Who Created the SWC Registry?</strong></h2>
<p class="sqsrte-large" style="white-space:pre-wrap;">The team behind <strong>MythX</strong> was indeed involved in the creation of the SWC Registry. They are among the experts from the blockchain community who contributed to the SWC working group, which proposed the idea and implemented the registry. The <strong>MythX</strong> team, which includes security experts like Bernhard Mueller and Joran Honig, is known for developing tools and services that help developers identify and fix security vulnerabilities in smart contracts, and their contributions to the SWC registry are part of that broader effort.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;"><strong>SWC Registry Repo:</strong><br /><a href="https://github.com/SmartContractSecurity/SWC-registry/" target="_blank" rel="noopener">https://github.com/SmartContractSecurity/SWC-registry/</a></p>
<h2 style="white-space:pre-wrap;"><strong>Example of Weakness Classes in the SWC:</strong></h2>
<h4 style="white-space:pre-wrap;"><span class="sqsrte-text-color--black"><strong>Reentrancy Vulnerability (SWC-107):</strong></span></h4>
<p class="sqsrte-large" style="white-space:pre-wrap;">Calling external contracts poses a significant risk as it can result in loss of control flow. An instance of such risk is the reentrancy attack, also known as the recursive call attack. In this attack, a malicious contract calls back into the calling contract before the initial invocation of the function is complete, causing multiple function invocations to interact in undesirable ways.</p>
<h4 style="white-space:pre-wrap;"><span class="sqsrte-text-color--black"><strong>DAO ATTACK:</strong></span></h4>
<p class="sqsrte-large" style="white-space:pre-wrap;">A DAO (Decentralized Autonomous Organization) attack in smart contracts refers to an exploit in the code of a decentralized autonomous organization that allows an attacker to steal or manipulate the organization’s assets.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">DAOs are essentially self-executing smart contracts that exist on a blockchain and operate autonomously without the need for intermediaries. They are designed to manage funds and make decisions through a voting system controlled by the members of the organization.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">In a DAO attack, a hacker finds a vulnerability in the smart contract code and exploits it to gain control over the organization’s funds or manipulate its decision-making process. This can be done through a variety of means, such as creating a malicious proposal that is approved by the voting system, exploiting a flaw in the code to drain the organization’s funds, or launching a denial-of-service attack to prevent members from voting.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">One infamous example of a DAO attack occurred in 2016 when an attacker exploited a vulnerability in the code of a DAO called “The DAO” and stole approximately one-third of the organization’s funds, worth around $50 million at the time. This incident highlighted the need for better security measures in smart contracts and the importance of conducting rigorous code audits before launching any DAO or other smart contract-based system.<br />Let’s take this smart contract to understand:</p>
<p class="sqsrte-large" style="white-space:pre-wrap;"><strong>simple_dao.sol:</strong> </p>
</div>
<div class="<br />
          image-block-outer-wrapper<br />
          layout-caption-below<br />
          design-layout-inline<br />
          combination-animation-site-default<br />
          individual-animation-site-default<br />
          individual-text-animation-site-default<br />
        " data-test="image-block-inline-outer-wrapper"><br />
<figure class="<br />
              sqs-block-image-figure<br />
              intrinsic<br />
            " style="max-width:727px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element</p>
<p>              has-aspect-ratio<br />
            " style="<br />
                position: relative;</p>
<p>                  padding-bottom:59.42228317260742%;</p>
<p>                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);<br />
              "></p></div>
</div>
<p><img data-stretch="false" src="{{ site.baseurl }}/assets/2023/05/Screenshot+2023-06-07+at+11.48.47.png" data-image="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ec01b2ed-6937-4b31-814b-e67c23cd1686/Screenshot+2023-06-07+at+11.48.47.png" data-image-dimensions="727x432" data-image-focal-point="0.5,0.5" alt="" data-load="false" width="727" height="432" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" srcset="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ec01b2ed-6937-4b31-814b-e67c23cd1686/Screenshot+2023-06-07+at+11.48.47.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ec01b2ed-6937-4b31-814b-e67c23cd1686/Screenshot+2023-06-07+at+11.48.47.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ec01b2ed-6937-4b31-814b-e67c23cd1686/Screenshot+2023-06-07+at+11.48.47.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ec01b2ed-6937-4b31-814b-e67c23cd1686/Screenshot+2023-06-07+at+11.48.47.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ec01b2ed-6937-4b31-814b-e67c23cd1686/Screenshot+2023-06-07+at+11.48.47.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ec01b2ed-6937-4b31-814b-e67c23cd1686/Screenshot+2023-06-07+at+11.48.47.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ec01b2ed-6937-4b31-814b-e67c23cd1686/Screenshot+2023-06-07+at+11.48.47.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" /></p>
</figure>
</div>
<div class="sqs-html-content">
<p class="sqsrte-large" style="white-space:pre-wrap;"><strong>SimpleDA.sol explication:</strong><br />This smart contract is a basic implementation of a decentralized autonomous organization. The contract has three functions: <code>donate</code>, <code>withdraw</code>, and <code>queryCredit</code>.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">The <code>donate</code> function is a payable function that can be called by anyone and takes an address parameter called “to”. This function allows the caller to send ether to the contract and adds the sent amount to the credit balance of the specified address (“to”) in the credit mapping.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">The <code>withdraw</code> function takes an amount parameter and allows the caller to withdraw a specified amount of ether from their credit balance if they have sufficient credit. The function first checks if the credit balance of the caller (msg.sender) is greater than or equal to the specified amount. If the balance is sufficient, the function uses the require statement to ensure that the caller is able to receive the ether by using the call function with the specified amount as an argument. If the call is successful, the function subtracts the specified amount from the credit balance of the caller.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">The <code>queryCredit</code> function takes an address parameter and returns the credit balance of the specified address from the credit mapping.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">The contract has a mapping called <code>credit</code> that maps addresses to uint values representing the credit balance of each address. The contract also uses the <code>msg.value</code> variable to obtain the amount of ether sent to the contract by the caller.<br /><strong>Is this smart contract vulnerable to Reentrancy Vulenrability??</strong><br />The answer is yes ;</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">The SimpleDAO contract is vulnerable to the reentrancy attack because it uses a “pull” approach to transfer ether to the caller’s account in the withdraw function. Specifically, the function uses the call function to transfer ether to the caller, but it does not update the caller’s credit balance until after the call function returns. This creates a vulnerability where a malicious contract or attacker can call the withdraw function repeatedly before the first invocation of the function is finished, effectively draining the contract of ether.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">Here’s how a reentrancy attack can be carried out on the SimpleDAO contract:</p>
<ol data-rte-list="default">
<li>
<p class="sqsrte-large" style="white-space:pre-wrap;">The attacker deploys a malicious contract that has a <code>fallback</code> function that calls the <code>withdraw</code> function of the SimpleDAO contract.</p>
</li>
<li>
<p class="sqsrte-large" style="white-space:pre-wrap;">The attacker calls the <code>donate</code> function of the SimpleDAO contract and sends a large amount of ether to the malicious contract</p>
</li>
<li>
<p class="sqsrte-large" style="white-space:pre-wrap;">the fallback function of the malicious contract called automatically after receiving ether , which calls the <code>withdraw</code> function of the SimpleDAO contract.</p>
</li>
<li>
<p class="sqsrte-large" style="white-space:pre-wrap;">The <code>withdraw</code> function transfers ether to the attacker’s contract using the call function without updating the credit balance of the attacker’s address in the credit mapping.</p>
</li>
<li>
<p class="sqsrte-large" style="white-space:pre-wrap;">The fallback function of the malicious contract is executed again, and the withdraw function of the SimpleDAO contract is called again.</p>
</li>
<li>
<p class="sqsrte-large" style="white-space:pre-wrap;">The <code>withdraw</code> function transfers ether to the attacker’s contract again, but this time it uses the credit balance from the previous invocation of the function, effectively allowing the attacker to drain the contract of all its ether.</p>
</li>
</ol>
<p class="sqsrte-large" style="white-space:pre-wrap;">Here is an example of the attacker smart contract MaliciousContract.sol:</p>
</div>
<div class="<br />
          image-block-outer-wrapper<br />
          layout-caption-below<br />
          design-layout-inline<br />
          combination-animation-site-default<br />
          individual-animation-site-default<br />
          individual-text-animation-site-default<br />
        " data-test="image-block-inline-outer-wrapper"><br />
<figure class="<br />
              sqs-block-image-figure<br />
              intrinsic<br />
            " style="max-width:727px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element</p>
<p>              has-aspect-ratio<br />
            " style="<br />
                position: relative;</p>
<p>                  padding-bottom:43.053646087646484%;</p>
<p>                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);<br />
              "></p></div>
</div>
<p><img data-stretch="false" src="{{ site.baseurl }}/assets/2023/05/Screenshot+2023-06-07+at+11.49.29.png" data-image="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ad211f93-4b91-4929-8a72-5784c49af76a/Screenshot+2023-06-07+at+11.49.29.png" data-image-dimensions="727x313" data-image-focal-point="0.5,0.5" alt="" data-load="false" width="727" height="313" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" srcset="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ad211f93-4b91-4929-8a72-5784c49af76a/Screenshot+2023-06-07+at+11.49.29.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ad211f93-4b91-4929-8a72-5784c49af76a/Screenshot+2023-06-07+at+11.49.29.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ad211f93-4b91-4929-8a72-5784c49af76a/Screenshot+2023-06-07+at+11.49.29.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ad211f93-4b91-4929-8a72-5784c49af76a/Screenshot+2023-06-07+at+11.49.29.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ad211f93-4b91-4929-8a72-5784c49af76a/Screenshot+2023-06-07+at+11.49.29.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ad211f93-4b91-4929-8a72-5784c49af76a/Screenshot+2023-06-07+at+11.49.29.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ad211f93-4b91-4929-8a72-5784c49af76a/Screenshot+2023-06-07+at+11.49.29.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" /></p>
</figure>
</div>
<div class="sqs-html-content">
<p class="sqsrte-large" style="white-space:pre-wrap;">This contract is designed to be the attacker contract in a reentrancy attack on the SimpleDAO contract. The contract takes the address of the SimpleDAO contract as a constructor argument and stores it in the dao state variable.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">The fallback function of the contract is external and payable, which means it can receive ether and be called from other contracts. In this case, the fallback function simply calls the withdraw function of the SimpleDAO contract with a withdrawal amount of 1 ether.</p>
<p class="sqsrte-large" style="white-space:pre-wrap;">When the SimpleDAO contract calls back into the malicious contract during the execution of the withdraw function, the fallback function of the malicious contract is executed again, allowing the attacker to repeatedly call the withdraw function and drain the contract of ether.</p>
<h2 style="white-space:pre-wrap;"><strong>Remediation:</strong></h2>
<p class="sqsrte-large" style="white-space:pre-wrap;"><strong>The best practices to avoid Reentrancy weaknesses are:</strong></p>
<ul data-rte-list="default">
<li>
<p class="sqsrte-large" style="white-space:pre-wrap;">Make sure all internal state changes are performed before the call is executed. This is known as the Checks-Effects-Interactions pattern</p>
</li>
<li>
<p class="sqsrte-large" style="white-space:pre-wrap;">Use a reentrancy lock (ie. OpenZeppelin’s ReentrancyGuard.</p>
</li>
</ul>
<p class="sqsrte-large" style="white-space:pre-wrap;">Here is the same sample dao contract with modification to remdiate against reetrency attack :</p>
</div>
<div class="<br />
          image-block-outer-wrapper<br />
          layout-caption-below<br />
          design-layout-inline<br />
          combination-animation-site-default<br />
          individual-animation-site-default<br />
          individual-text-animation-site-default<br />
        " data-test="image-block-inline-outer-wrapper"><br />
<figure class="<br />
              sqs-block-image-figure<br />
              intrinsic<br />
            " style="max-width:727px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element</p>
<p>              has-aspect-ratio<br />
            " style="<br />
                position: relative;</p>
<p>                  padding-bottom:59.147178649902344%;</p>
<p>                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);<br />
              "></p></div>
</div>
<p><img data-stretch="false" src="{{ site.baseurl }}/assets/2023/05/Screenshot+2023-06-07+at+11.50.24.png" data-image="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/6ff13dbc-f187-4653-9903-76e23ff38d37/Screenshot+2023-06-07+at+11.50.24.png" data-image-dimensions="727x430" data-image-focal-point="0.5,0.5" alt="" data-load="false" width="727" height="430" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" srcset="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/6ff13dbc-f187-4653-9903-76e23ff38d37/Screenshot+2023-06-07+at+11.50.24.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/6ff13dbc-f187-4653-9903-76e23ff38d37/Screenshot+2023-06-07+at+11.50.24.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/6ff13dbc-f187-4653-9903-76e23ff38d37/Screenshot+2023-06-07+at+11.50.24.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/6ff13dbc-f187-4653-9903-76e23ff38d37/Screenshot+2023-06-07+at+11.50.24.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/6ff13dbc-f187-4653-9903-76e23ff38d37/Screenshot+2023-06-07+at+11.50.24.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/6ff13dbc-f187-4653-9903-76e23ff38d37/Screenshot+2023-06-07+at+11.50.24.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/6ff13dbc-f187-4653-9903-76e23ff38d37/Screenshot+2023-06-07+at+11.50.24.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" /></p>
</figure>
</div>
<div class="sqs-html-content">
<h2 style="white-space:pre-wrap;"><strong>Conclusion…</strong></h2>
<p class="sqsrte-large" style="white-space:pre-wrap;">In conclusion, the SWC Registry is an essential resource for developers to identify and mitigate security risks in their smart contract code. By staying informed of the latest vulnerabilities and implementing best practices, developers can ensure the security and integrity of their code. However, as vulnerabilities can be complex and difficult to identify, it is often best to seek out professional security auditing services. Our company, SCT ITALIA, offers audit security services to help ensure that your token contract is secure and free from vulnerabilities that can be exploited by attackers. By taking proactive measures to secure your token, you can reduce the risk of financial losses and protect the investments of your users.</p>
</div>
